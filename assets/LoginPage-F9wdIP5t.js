import{c as Y,j as e,u as Z,a as ee,b as te,r as l,B as c,C as se,I as re,T as a,A as k,e as x,f as M,D as ae,d as X,g as A,h as R,i as $,k as ie}from"./index-CJ6MaM8b.js";import{a as v}from"./api-Pfy0Ae3B.js";import{A as ne}from"./ArrowBack-DFZbt0oL.js";import{m as W}from"./proxy-CfQB7XH1.js";import{C as oe,a as le}from"./CardContent-D-MrYNNE.js";import{T as de,a as I}from"./Tabs-wcc-KV3z.js";import{F as L,L as ce}from"./Lock-OhD6BRKv.js";import{P as H}from"./PhoneAndroid-DeBPeJmZ.js";import{T as S}from"./TextField-Dxn9Ud9w.js";import{I as C}from"./InputAdornment-BPlPIyXc.js";import{C as he}from"./CheckCircle-BdOVru3d.js";import{P as xe}from"./Person-BBEOXa6S.js";import"./useFormControl-RHgvjy84.js";import"./isMuiElement-CUTupkmi.js";const U=Y(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.75c0-1 2-1.5 3-1.5s3 .5 3 1.5zm1-9h-2V4h2zm5 7.5h-4V15h4zm0-3h-4V12h4z"}),"Badge"),Ae=()=>{const{t:p}=Z(),f=ee(),i=te(),[u,d]=l.useState(!1),[z,m]=l.useState(""),[w,b]=l.useState(!1),[s,V]=l.useState(0),[j,B]=l.useState(""),[n,G]=l.useState(""),[h,N]=l.useState(""),[y,T]=l.useState(""),F=t=>t.replace(/\D/g,"").slice(0,12).replace(/(\d{4})(?=\d)/g,"$1 "),K=t=>{B(F(t.target.value))},O=()=>s===0?j.replace(/\s/g,""):s===1?n:h,_=()=>s===0?j.replace(/\s/g,"").length===12:s===1?/^\d{10}$/.test(n):h.length>=3,D=async()=>{d(!0),m("");try{const t=O();s===0?await v.post("/auth/aadhaar/send-otp",{aadhaar:t}):s===1?await v.post("/auth/aadhaar/send-otp",{aadhaar:`999${n}99`}):await v.post("/auth/consumer/send-otp",{consumerId:t,mobile:"9999999999"}),b(!0),i(A({message:"OTP sent successfully! (Use any 6-digit OTP for demo)",severity:"success"}))}catch{b(!0),i(A({message:"OTP sent! (Use any 6-digit OTP for demo)",severity:"info"}))}finally{d(!1)}},q=async()=>{var t,g;if(y.length!==6){m("Please enter a valid 6-digit OTP");return}d(!0),i(R());try{let o=O();s===1?o=`999${n}99`:s===2&&(o=h.padStart(12,"0").slice(0,12));const r=(await v.post("/auth/aadhaar/verify-otp",{aadhaar:o,otp:y})).data;if(!r.success)throw new Error(r.error||"Login failed");const E=r.user.name!=="New User"?r.user.name:s===0?`Citizen *${o.slice(-4)}`:s===1?`User ${n.slice(-4)}`:`Consumer ${h}`;i($({user:{id:r.user.id,name:E,mobile:r.user.mobile||n||"",email:r.user.email||"",aadhaarMasked:r.user.aadhaarMasked||`XXXX-XXXX-${o.slice(-4)}`,address:r.user.address||"",connections:r.user.connections||{}},token:r.token,refreshToken:r.refreshToken,expiresIn:r.expiresIn||900})),d(!1),i(A({message:`Welcome, ${E}!`,severity:"success"})),f("/dashboard")}catch(P){d(!1);const o=((g=(t=P.response)==null?void 0:t.data)==null?void 0:g.error)||P.message||"Login failed. Please try again.";m(o),i(ie(o))}},J=async()=>{d(!0),i(R()),await new Promise(t=>setTimeout(t,800)),i($({user:{id:"GUEST",name:"Guest User",mobile:"",connections:{}},token:"guest-token",refreshToken:"guest-refresh",expiresIn:300,isGuest:!0})),d(!1),f("/dashboard")},Q=(t,g)=>{V(g),b(!1),m(""),T("")};return e.jsx(c,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",py:4},children:e.jsxs(se,{maxWidth:"sm",children:[e.jsx(re,{onClick:()=>f("/"),sx:{mb:2,backgroundColor:"white",boxShadow:1},children:e.jsx(ne,{})}),e.jsx(W.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(c,{sx:{textAlign:"center",mb:3},children:[e.jsx(c,{component:"img",src:"/Suvidha-Kisok/logo.png",alt:"SUVIDHA",sx:{width:80,height:80,borderRadius:"50%",objectFit:"cover",boxShadow:"0 8px 32px rgba(26, 115, 232, 0.3)",mb:1.5,display:"block",mx:"auto"}}),e.jsx(a,{variant:"h5",sx:{fontWeight:700,color:"primary.main"},children:"SUVIDHA"}),e.jsx(a,{variant:"caption",color:"text.secondary",children:"Unified Smart Kiosk for Civic Services"})]})}),e.jsx(W.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsx(oe,{elevation:4,sx:{borderRadius:4},children:e.jsxs(le,{sx:{p:{xs:2.5,sm:4}},children:[e.jsx(a,{variant:"h6",align:"center",sx:{mb:.5,fontWeight:700},children:p("auth.loginTitle")}),e.jsx(a,{variant:"body2",align:"center",color:"text.secondary",sx:{mb:2},children:"Choose your preferred login method"}),z&&e.jsx(k,{severity:"error",sx:{mb:2,borderRadius:2},children:z}),!w&&e.jsxs(de,{value:s,onChange:Q,variant:"fullWidth",sx:{mb:3,bgcolor:"grey.50",borderRadius:2,"& .MuiTab-root":{fontWeight:600,fontSize:"0.75rem",minHeight:48,textTransform:"none"}},children:[e.jsx(I,{icon:e.jsx(L,{sx:{fontSize:18}}),iconPosition:"start",label:"Aadhaar"}),e.jsx(I,{icon:e.jsx(H,{sx:{fontSize:18}}),iconPosition:"start",label:"Mobile"}),e.jsx(I,{icon:e.jsx(U,{sx:{fontSize:18}}),iconPosition:"start",label:"Consumer ID"})]}),w?e.jsxs(W.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3},children:[e.jsxs(k,{severity:"success",sx:{mb:2,borderRadius:2},children:["OTP sent to ",s===0?`Aadhaar ${j}`:s===1?`+91-${n}`:`Consumer ${h}`]}),e.jsx(a,{variant:"body2",color:"text.secondary",align:"center",sx:{mb:2},children:"Enter the 6-digit OTP sent to your registered mobile"}),e.jsx(S,{fullWidth:!0,label:"Enter 6-digit OTP",value:y,onChange:t=>T(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"â— â— â— â— â— â—",inputProps:{style:{textAlign:"center",letterSpacing:8,fontSize:20,fontWeight:700}},InputProps:{startAdornment:e.jsx(C,{position:"start",children:e.jsx(ce,{color:"primary"})})},sx:{mb:2}}),e.jsxs(c,{sx:{display:"flex",gap:1.5},children:[e.jsx(x,{variant:"outlined",onClick:()=>{b(!1),T(""),m("")},sx:{flex:1,minHeight:48,borderRadius:2},children:"Back"}),e.jsx(x,{variant:"contained",onClick:q,disabled:y.length!==6||u,sx:{flex:2,minHeight:48,borderRadius:2,fontWeight:600,background:"linear-gradient(135deg, #34a853 0%, #2e7d32 100%)"},children:u?e.jsx(M,{size:24,color:"inherit"}):"Verify & Login"})]}),e.jsx(x,{fullWidth:!0,variant:"text",size:"small",sx:{mt:1.5},onClick:D,children:"Resend OTP"})]}):e.jsxs(e.Fragment,{children:[s===0&&e.jsx(S,{fullWidth:!0,label:"Enter 12-digit Aadhaar Number",value:j,onChange:K,placeholder:"XXXX XXXX XXXX",InputProps:{startAdornment:e.jsx(C,{position:"start",children:e.jsx(L,{color:"primary"})})},sx:{mb:2}}),s===1&&e.jsx(S,{fullWidth:!0,label:"Enter 10-digit Mobile Number",value:n,onChange:t=>G(t.target.value.replace(/\D/g,"").slice(0,10)),placeholder:"98XXXXXXXX",InputProps:{startAdornment:e.jsxs(C,{position:"start",children:[e.jsx(H,{color:"primary"}),e.jsx(a,{sx:{ml:.5,color:"text.secondary",fontSize:14},children:"+91"})]})},sx:{mb:2}}),s===2&&e.jsx(S,{fullWidth:!0,label:"Enter Consumer / Connection ID",value:h,onChange:t=>N(t.target.value),placeholder:"e.g., ELC-001, GAS-5001, WAT-3001",InputProps:{startAdornment:e.jsx(C,{position:"start",children:e.jsx(U,{color:"primary"})})},helperText:"Electricity, Gas, or Water connection ID",sx:{mb:2}}),e.jsx(x,{fullWidth:!0,variant:"contained",size:"large",onClick:D,disabled:!_()||u,sx:{minHeight:52,borderRadius:2,fontWeight:600,background:"linear-gradient(135deg, #1a73e8 0%, #1565c0 100%)"},children:u?e.jsx(M,{size:24,color:"inherit"}):"Send OTP"}),e.jsx(k,{severity:"info",icon:e.jsx(he,{}),sx:{mt:2,borderRadius:2},children:e.jsxs(a,{variant:"caption",children:[e.jsx("strong",{children:"Demo Mode:"})," Enter any valid ",s===0?"12-digit number":s===1?"10-digit mobile":"ID"," and use any 6-digit OTP (e.g., 123456) to login."]})})]}),e.jsx(ae,{sx:{my:2.5},children:e.jsx(a,{variant:"body2",color:"text.secondary",children:"OR"})}),e.jsx(x,{fullWidth:!0,variant:"outlined",size:"large",startIcon:e.jsx(xe,{}),onClick:J,disabled:u,sx:{minHeight:52,borderRadius:2,fontWeight:600,borderWidth:2,"&:hover":{borderWidth:2}},children:p("auth.guestMode")}),e.jsx(a,{variant:"caption",display:"block",textAlign:"center",color:"text.secondary",sx:{mt:1.5},children:"Guest mode has limited access. Session expires in 5 minutes."})]})})}),e.jsx(c,{sx:{textAlign:"center",mt:3},children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:[p("auth.newUser")," ",e.jsx(x,{variant:"text",onClick:()=>f("/register"),sx:{textTransform:"none",fontWeight:600},children:p("auth.registerNow")})]})}),e.jsx(c,{sx:{textAlign:"center",mt:3},children:e.jsxs(c,{sx:{display:"flex",justifyContent:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(X,{label:"ğŸ”’ 256-bit SSL",size:"small",variant:"outlined",sx:{fontSize:11}}),e.jsx(X,{label:"ğŸ›ï¸ DPDP Compliant",size:"small",variant:"outlined",sx:{fontSize:11}}),e.jsx(X,{label:"â™¿ WCAG 2.1",size:"small",variant:"outlined",sx:{fontSize:11}})]})})]})})};export{Ae as default};
//# sourceMappingURL=LoginPage-F9wdIP5t.js.map
