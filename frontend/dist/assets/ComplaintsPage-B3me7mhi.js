import{p as O,q as V,r as n,t as Y,j as e,v as z,w as J,x as P,y as C,z as E,c as se,u as ve,b as ye,E as fe,L as je,W as be,B as g,m as T,T as i,d as R,C as D,e as ee,A as G,F as B,I as Ie,f as L,G as we}from"./index-CB2N0l4K.js";import{C as Ce}from"./Check-BeAiuRRN.js";import{G as f}from"./Grid-DABZo0jZ.js";import{C as F,a as U}from"./CardContent-C_QREZG8.js";import{S as Se,a as Le,b as Re}from"./Stepper-BqEZiy-N.js";import{M as Pe}from"./MyLocation-DdPlSmmP.js";import{T as te}from"./TextField-BJjxtUBQ.js";import{R as We,a as k}from"./RadioGroup-BvJN9qom.js";import{i as Me}from"./isMuiElement-D4UqNhTQ.js";import{D as Ae}from"./Delete-Bo1cJy2k.js";import{S as Be}from"./Schedule-Cj_DeHST.js";import{P as ke}from"./Person-B7g_v5XR.js";import"./FormGroup-BByeX-Lv.js";function ze(s){return O("MuiImageList",s)}V("MuiImageList",["root","masonry","quilted","standard","woven"]);const oe=n.createContext({}),Ee=s=>{const{classes:o,variant:r}=s;return J({root:["root",r]},ze,o)},Ne=P("ul",{name:"MuiImageList",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[o.root,o[r.variant]]}})({display:"grid",overflowY:"auto",listStyle:"none",padding:0,WebkitOverflowScrolling:"touch",variants:[{props:{variant:"masonry"},style:{display:"block"}}]}),$e=n.forwardRef(function(o,r){const a=Y({props:o,name:"MuiImageList"}),{children:x,className:m,cols:b=2,component:u="ul",rowHeight:h="auto",gap:c=4,style:S,variant:l="standard",...v}=a,y=n.useMemo(()=>({rowHeight:h,gap:c,variant:l}),[h,c,l]),I=l==="masonry"?{columnCount:b,columnGap:c,...S}:{gridTemplateColumns:`repeat(${b}, 1fr)`,gap:c,...S},j={...a,component:u,gap:c,rowHeight:h,variant:l},w=Ee(j);return e.jsx(Ne,{as:u,className:z(w.root,w[l],m),ref:r,style:I,ownerState:j,...v,children:e.jsx(oe.Provider,{value:y,children:x})})});function Te(s){return O("MuiImageListItem",s)}const H=V("MuiImageListItem",["root","img","standard","woven","masonry","quilted"]),De=s=>{const{classes:o,variant:r}=s;return J({root:["root",r],img:["img"]},Te,o)},Ge=P("li",{name:"MuiImageListItem",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[{[`& .${H.img}`]:o.img},o.root,o[r.variant]]}})({display:"block",position:"relative",[`& .${H.img}`]:{objectFit:"cover",width:"100%",height:"100%",display:"block"},variants:[{props:{variant:"standard"},style:{display:"flex",flexDirection:"column"}},{props:{variant:"woven"},style:{height:"100%",alignSelf:"center","&:nth-of-type(even)":{height:"70%"}}},{props:{variant:"standard"},style:{[`& .${H.img}`]:{height:"auto",flexGrow:1}}}]}),Fe=n.forwardRef(function(o,r){const a=Y({props:o,name:"MuiImageListItem"}),{children:x,className:m,cols:b=1,component:u="li",rows:h=1,style:c,...S}=a,{rowHeight:l="auto",gap:v,variant:y}=n.useContext(oe);let I="auto";y==="woven"?I=void 0:l!=="auto"&&(I=l*h+v*(h-1));const j={...a,cols:b,component:u,gap:v,rowHeight:l,rows:h,variant:y},w=De(j);return e.jsx(Ge,{as:u,className:z(w.root,w[y],m),ref:r,style:{height:I,gridColumnEnd:y!=="masonry"?`span ${b}`:void 0,gridRowEnd:y!=="masonry"?`span ${h}`:void 0,marginBottom:y==="masonry"?v:void 0,breakInside:y==="masonry"?"avoid":void 0,...c},ownerState:j,...S,children:n.Children.map(x,p=>n.isValidElement(p)?p.type==="img"||Me(p,["Image"])?n.cloneElement(p,{className:z(w.img,p.props.className)}):p:null)})});function Ue(s){return O("MuiImageListItemBar",s)}V("MuiImageListItemBar",["root","positionBottom","positionTop","positionBelow","actionPositionLeft","actionPositionRight","titleWrap","titleWrapBottom","titleWrapTop","titleWrapBelow","titleWrapActionPosLeft","titleWrapActionPosRight","title","subtitle","actionIcon","actionIconActionPosLeft","actionIconActionPosRight"]);const He=s=>{const{classes:o,position:r,actionIcon:a,actionPosition:x}=s,m={root:["root",`position${C(r)}`,`actionPosition${C(x)}`],titleWrap:["titleWrap",`titleWrap${C(r)}`,a&&`titleWrapActionPos${C(x)}`],title:["title"],subtitle:["subtitle"],actionIcon:["actionIcon",`actionIconActionPos${C(x)}`]};return J(m,Ue,o)},Oe=P("div",{name:"MuiImageListItemBar",slot:"Root",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[o.root,o[`position${C(r.position)}`]]}})(E(({theme:s})=>({position:"absolute",left:0,right:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",fontFamily:s.typography.fontFamily,variants:[{props:{position:"bottom"},style:{bottom:0}},{props:{position:"top"},style:{top:0}},{props:{position:"below"},style:{position:"relative",background:"transparent",alignItems:"normal"}}]}))),Ve=P("div",{name:"MuiImageListItemBar",slot:"TitleWrap",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[o.titleWrap,o[`titleWrap${C(r.position)}`],r.actionIcon&&o[`titleWrapActionPos${C(r.actionPosition)}`]]}})(E(({theme:s})=>({flexGrow:1,padding:"12px 16px",color:(s.vars||s).palette.common.white,overflow:"hidden",variants:[{props:{position:"below"},style:{padding:"6px 0 12px",color:"inherit"}},{props:({ownerState:o})=>o.actionIcon&&o.actionPosition==="left",style:{paddingLeft:0}},{props:({ownerState:o})=>o.actionIcon&&o.actionPosition==="right",style:{paddingRight:0}}]}))),Ye=P("div",{name:"MuiImageListItemBar",slot:"Title",overridesResolver:(s,o)=>o.title})(E(({theme:s})=>({fontSize:s.typography.pxToRem(16),lineHeight:"24px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}))),Je=P("div",{name:"MuiImageListItemBar",slot:"Subtitle",overridesResolver:(s,o)=>o.subtitle})(E(({theme:s})=>({fontSize:s.typography.pxToRem(12),lineHeight:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}))),qe=P("div",{name:"MuiImageListItemBar",slot:"ActionIcon",overridesResolver:(s,o)=>{const{ownerState:r}=s;return[o.actionIcon,o[`actionIconActionPos${C(r.actionPosition)}`]]}})({variants:[{props:{actionPosition:"left"},style:{order:-1}}]}),_e=n.forwardRef(function(o,r){const a=Y({props:o,name:"MuiImageListItemBar"}),{actionIcon:x,actionPosition:m="right",className:b,subtitle:u,title:h,position:c="bottom",...S}=a,l={...a,position:c,actionPosition:m},v=He(l);return e.jsxs(Oe,{ownerState:l,className:z(v.root,b),ref:r,...S,children:[e.jsxs(Ve,{ownerState:l,className:v.titleWrap,children:[e.jsx(Ye,{className:v.title,children:h}),u?e.jsx(Je,{className:v.subtitle,children:u}):null]}),x?e.jsx(qe,{ownerState:l,className:v.actionIcon,children:x}):null]})}),Ke=se(e.jsx("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload"),Qe=se(e.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2m-8 12.5v-9l6 4.5z"}),"VideoLibrary"),mt=()=>{var X;const{t:s}=ve(),o=ye(),r=n.useRef(null),[a,x]=n.useState(0),[m,b]=n.useState(""),[u,h]=n.useState(""),[c,S]=n.useState("medium"),[l,v]=n.useState(""),[y,I]=n.useState(""),[j,w]=n.useState(null),[p,N]=n.useState([]),[q,_]=n.useState(!1),[$,A]=n.useState(!1),[ie,K]=n.useState(!1),[re,ae]=n.useState(""),ne=[s("complaints.selectCategory"),"Location & Details",s("complaints.uploadPhotos"),"Review & Submit"],Q=[{id:"electricity",icon:e.jsx(fe,{}),label:s("services.electricity"),color:"#fbbc04",subcategories:["Power Outage","Voltage Fluctuation","Meter Problem","Street Light Issue","Billing Dispute","Illegal Connection","Transformer Issue"]},{id:"gas",icon:e.jsx(je,{}),label:s("services.gas"),color:"#ea4335",subcategories:["Gas Leak (EMERGENCY)","Low Pressure","Meter Issue","Billing Dispute","PNG Connection Problem","Pipeline Damage"]},{id:"water",icon:e.jsx(be,{}),label:s("services.water"),color:"#1a73e8",subcategories:["No Water Supply","Low Pressure","Water Quality Issue","Pipeline Leakage","Sewage Overflow","Meter Problem","Billing Dispute"]}],le=[{id:"CMP-2026-001",category:"electricity",subcategory:"Power Outage",status:"in_progress",createdAt:"25 Jan 2026",estimatedResolution:"28 Jan 2026",officer:{name:"Rajesh Kumar",designation:"Junior Engineer",phone:"+91 22 1234 5678"}},{id:"CMP-2026-002",category:"water",subcategory:"Low Pressure",status:"resolved",createdAt:"20 Jan 2026",resolvedAt:"23 Jan 2026"}],ce=t=>{switch(t){case"registered":return"info";case"assigned":return"secondary";case"in_progress":return"warning";case"resolved":return"success";default:return"default"}},de=()=>{A(!0),"geolocation"in navigator?navigator.geolocation.getCurrentPosition(async t=>{const{latitude:d,longitude:W}=t.coords;w({lat:d,lng:W}),I(`Near coordinates: ${d.toFixed(4)}, ${W.toFixed(4)}`),A(!1),o(L({message:"Location captured successfully",severity:"success"}))},t=>{A(!1),o(L({message:"Could not get location",severity:"error"}))},{enableHighAccuracy:!0,timeout:1e4}):(A(!1),o(L({message:"Geolocation not supported",severity:"error"})))},me=t=>{const d=t.target.files;if(!d)return;const W=[];Array.from(d).forEach(M=>{if(p.length+W.length>=5){o(L({message:"Maximum 5 files allowed",severity:"warning"}));return}if(M.size>10*1024*1024){o(L({message:`${M.name} is too large (max 10MB)`,severity:"error"}));return}const Z=M.type.startsWith("image/"),xe=M.type.startsWith("video/");if(!Z&&!xe){o(L({message:"Only images and videos allowed",severity:"error"}));return}const he=URL.createObjectURL(M);W.push({file:M,preview:he,type:Z?"image":"video"})}),N([...p,...W])},ue=t=>{const d=[...p];URL.revokeObjectURL(d[t].preview),d.splice(t,1),N(d)},pe=async()=>{_(!0),await new Promise(d=>setTimeout(d,2e3));const t=`CMP-2026-${String(Math.floor(Math.random()*900)+100)}`;ae(t),o(we({id:t,type:m,category:u,subcategory:u,description:l,location:j?{...j,address:y}:{lat:0,lng:0,address:y},priority:c,status:"registered",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),attachments:p.map(d=>d.file.name),updates:[{timestamp:new Date().toISOString(),status:"registered",message:"Complaint registered successfully",by:"System"}]})),_(!1),K(!0),o(L({message:"Complaint submitted successfully!",severity:"success"}))},ge=t=>{o(L({message:`Complaint ${t} escalated to senior officer`,severity:"success"}))};return ie?e.jsxs(g,{children:[e.jsxs(T,{elevation:0,sx:{p:4,textAlign:"center",background:"linear-gradient(135deg, #34a853 0%, #1e8e3e 100%)",borderRadius:3,color:"white"},children:[e.jsx(Ce,{sx:{fontSize:64,mb:2}}),e.jsx(i,{variant:"h4",sx:{fontWeight:700,mb:2},children:"Complaint Registered Successfully!"}),e.jsxs(i,{variant:"h5",sx:{mb:1},children:[s("complaints.complaintNumber"),": ",e.jsx("strong",{children:re})]}),e.jsx(i,{variant:"body1",sx:{opacity:.9,mb:3},children:"You will receive SMS updates on your registered mobile number"}),e.jsxs(i,{variant:"body2",children:[s("complaints.estimatedResolution"),": 48 hours"]})]}),e.jsxs(g,{sx:{mt:4,display:"flex",gap:2,justifyContent:"center"},children:[e.jsx(R,{variant:"contained",onClick:()=>{K(!1),x(0),b(""),h(""),v(""),I(""),w(null),N([])},children:"Register Another Complaint"}),e.jsx(R,{variant:"outlined",onClick:()=>window.location.reload(),children:"View My Complaints"})]})]}):e.jsxs(g,{children:[e.jsxs(T,{elevation:0,sx:{p:3,mb:4,background:"linear-gradient(135deg, #e37400 0%, #ff9800 100%)",borderRadius:3,color:"white"},children:[e.jsx(i,{variant:"h4",sx:{fontWeight:700,mb:1},children:s("complaints.title")}),e.jsx(i,{variant:"body1",sx:{opacity:.9},children:"Register new complaints and track existing ones"})]}),e.jsxs(f,{container:!0,spacing:4,children:[e.jsx(f,{size:{xs:12,md:7},children:e.jsx(F,{sx:{borderRadius:3},children:e.jsxs(U,{children:[e.jsx(i,{variant:"h6",sx:{mb:3,fontWeight:600},children:"Register New Complaint"}),e.jsx(Se,{activeStep:a,sx:{mb:4},alternativeLabel:!0,children:ne.map(t=>e.jsx(Le,{children:e.jsx(Re,{children:t})},t))}),a===0&&e.jsxs(g,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Select Service Type"}),e.jsx(f,{container:!0,spacing:2,sx:{mb:3},children:Q.map(t=>e.jsx(f,{size:{xs:4},children:e.jsx(F,{variant:m===t.id?"elevation":"outlined",sx:{cursor:"pointer",borderColor:m===t.id?t.color:"divider",borderWidth:m===t.id?2:1,transition:"all 0.2s","&:hover":{transform:"scale(1.02)"}},onClick:()=>{b(t.id),h("")},children:e.jsxs(U,{sx:{textAlign:"center",py:3},children:[e.jsx(g,{sx:{color:t.color,mb:1},children:t.icon}),e.jsx(i,{variant:"body2",sx:{fontWeight:600},children:t.label})]})})},t.id))}),m&&e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"subtitle2",sx:{mb:2,fontWeight:600},children:"Select Issue Type"}),e.jsx(g,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:(X=Q.find(t=>t.id===m))==null?void 0:X.subcategories.map(t=>e.jsx(D,{label:t,onClick:()=>h(t),color:u===t?"primary":"default",variant:u===t?"filled":"outlined",sx:{cursor:"pointer",fontSize:t.includes("EMERGENCY")?14:13,color:t.includes("EMERGENCY")&&u!==t?"error.main":void 0,borderColor:t.includes("EMERGENCY")?"error.main":void 0}},t))})]})]}),a===1&&e.jsxs(g,{children:[e.jsx(R,{variant:"outlined",startIcon:$?e.jsx(ee,{size:20}):e.jsx(Pe,{}),fullWidth:!0,onClick:de,disabled:$,sx:{mb:2,minHeight:56},children:$?"Getting Location...":s("complaints.autoDetect")}),j&&e.jsxs(G,{severity:"success",sx:{mb:2},children:["Location captured: ",j.lat.toFixed(4),", ",j.lng.toFixed(4)]}),e.jsx(te,{fullWidth:!0,label:"Address / Landmark",placeholder:"Enter your address or nearby landmark",value:y,onChange:t=>I(t.target.value),sx:{mb:3}}),e.jsx(te,{fullWidth:!0,label:s("complaints.describeIssue"),multiline:!0,rows:4,value:l,onChange:t=>v(t.target.value),placeholder:"Describe your issue in detail...",sx:{mb:3}}),e.jsx(i,{variant:"subtitle2",sx:{mb:1,fontWeight:600},children:s("complaints.priority")}),e.jsxs(We,{row:!0,value:c,onChange:t=>S(t.target.value),children:[e.jsx(B,{value:"low",control:e.jsx(k,{}),label:s("complaints.low")}),e.jsx(B,{value:"medium",control:e.jsx(k,{}),label:s("complaints.medium")}),e.jsx(B,{value:"high",control:e.jsx(k,{color:"error"}),label:s("complaints.high")}),e.jsx(B,{value:"emergency",control:e.jsx(k,{color:"error"}),label:s("complaints.emergency")})]})]}),a===2&&e.jsxs(g,{children:[e.jsx("input",{type:"file",ref:r,onChange:me,accept:"image/*,video/*",multiple:!0,style:{display:"none"}}),e.jsx(R,{variant:"outlined",startIcon:e.jsx(Ke,{}),fullWidth:!0,onClick:()=>{var t;return(t=r.current)==null?void 0:t.click()},sx:{mb:3,minHeight:80,borderStyle:"dashed"},children:e.jsxs(g,{sx:{textAlign:"center"},children:[e.jsx(i,{children:s("complaints.uploadPhotos")}),e.jsx(i,{variant:"caption",color:"text.secondary",children:"Max 5 files, 10MB each (Images or Videos)"})]})}),p.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{variant:"subtitle2",sx:{mb:2},children:["Uploaded Files (",p.length,"/5)"]}),e.jsx($e,{cols:3,rowHeight:120,gap:8,children:p.map((t,d)=>e.jsxs(Fe,{children:[t.type==="image"?e.jsx("img",{src:t.preview,alt:`Attachment ${d+1}`,style:{height:120,objectFit:"cover",borderRadius:8}}):e.jsx(g,{sx:{height:120,bgcolor:"grey.200",borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Qe,{sx:{fontSize:40,color:"grey.500"}})}),e.jsx(_e,{subtitle:t.file.name.slice(0,15)+"...",actionIcon:e.jsx(Ie,{sx:{color:"white"},onClick:()=>ue(d),children:e.jsx(Ae,{})})})]},d))})]}),e.jsx(G,{severity:"info",sx:{mt:2},children:"Photos/videos help us understand and resolve your issue faster"})]}),a===3&&e.jsxs(g,{children:[e.jsx(T,{variant:"outlined",sx:{p:2,mb:3,borderRadius:2},children:e.jsxs(f,{container:!0,spacing:2,children:[e.jsxs(f,{size:{xs:6},children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Category"}),e.jsx(i,{variant:"body1",sx:{fontWeight:500},children:m})]}),e.jsxs(f,{size:{xs:6},children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Issue Type"}),e.jsx(i,{variant:"body1",sx:{fontWeight:500},children:u})]}),e.jsxs(f,{size:{xs:6},children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Priority"}),e.jsx(D,{label:c,size:"small",color:c==="high"||c==="emergency"?"error":c==="medium"?"warning":"default"})]}),e.jsxs(f,{size:{xs:6},children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Attachments"}),e.jsxs(i,{variant:"body1",children:[p.length," files"]})]}),e.jsxs(f,{size:{xs:12},children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Location"}),e.jsx(i,{variant:"body2",children:y||"Not provided"})]}),e.jsxs(f,{size:{xs:12},children:[e.jsx(i,{variant:"caption",color:"text.secondary",children:"Description"}),e.jsx(i,{variant:"body2",children:l})]})]})}),e.jsxs(G,{severity:"info",children:["Expected resolution time: ",c==="emergency"?"4 hours":c==="high"?"24 hours":"48 hours"]})]}),e.jsxs(g,{sx:{display:"flex",gap:2,mt:4},children:[e.jsx(R,{variant:"outlined",disabled:a===0,onClick:()=>x(t=>t-1),sx:{flex:1,minHeight:48},children:s("common.back")}),e.jsx(R,{variant:"contained",onClick:()=>{a===3?pe():x(t=>t+1)},disabled:a===0&&(!m||!u)||a===1&&!l||q,sx:{flex:2,minHeight:48},children:q?e.jsx(ee,{size:24}):s(a===3?"complaints.submitComplaint":"common.next")})]})]})})}),e.jsxs(f,{size:{xs:12,md:5},children:[e.jsx(i,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Your Complaints"}),le.map(t=>e.jsx(F,{sx:{mb:2,borderRadius:2},children:e.jsxs(U,{children:[e.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",mb:2},children:[e.jsx(i,{variant:"subtitle2",sx:{fontWeight:600},children:t.id}),e.jsx(D,{label:s(`complaints.status.${t.status}`),size:"small",color:ce(t.status)})]}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:t.subcategory}),e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Be,{sx:{fontSize:16,color:"text.secondary"}}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Created: ",t.createdAt]})]}),t.officer&&e.jsxs(g,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(ke,{sx:{fontSize:16,color:"text.secondary"}}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Assigned to: ",t.officer.name]})]}),t.status==="in_progress"&&e.jsx(R,{variant:"outlined",color:"warning",size:"small",fullWidth:!0,onClick:()=>ge(t.id),sx:{mt:1},children:"Escalate to Senior Officer"})]})},t.id))]})]})]})};export{mt as default};
//# sourceMappingURL=ComplaintsPage-B3me7mhi.js.map
