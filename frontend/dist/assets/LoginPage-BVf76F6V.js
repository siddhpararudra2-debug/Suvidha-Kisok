import{c as D,j as e,u as $,a as J,b as _,r as n,B as d,I as q,T as i,A as X,d as o,e as y,D as K,f as I,g as P,h as W,i as Q}from"./index-Bf1UkDuD.js";import{C as Y}from"./Container-dZCo0UDi.js";import{A as Z}from"./ArrowBack-D83Wpg4d.js";import{m as H}from"./proxy-IO3Btdun.js";import{C as ee,a as te}from"./CardContent-DHaZ8nUs.js";import{T as se,a as C}from"./Tabs-B4A1PBzr.js";import{F as z,L as ae}from"./Lock-BJ3tdaWF.js";import{T as p}from"./TextField-dkwN3UaY.js";import{I as j}from"./InputAdornment-CaZZSKOb.js";import{P as re}from"./Phone-D5wROajt.js";import{P as ne}from"./Person-BFBBg8xo.js";import"./useThemeProps-CQJBnnSr.js";import"./useFormControl-5VZQVgpF.js";const O=D(e.jsx("path",{d:"M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2zm-9-2h10V8H12zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"AccountBalanceWallet"),L=D(e.jsx("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.75c0-1 2-1.5 3-1.5s3 .5 3 1.5zm1-9h-2V4h2zm5 7.5h-4V15h4zm0-3h-4V12h4z"}),"Badge"),S=({children:s,value:h,index:r})=>e.jsx("div",{role:"tabpanel",hidden:h!==r,children:h===r&&e.jsx(d,{sx:{pt:3},children:s})}),be=()=>{const{t:s}=$(),h=J(),r=_(),[u,V]=n.useState(0),[l,c]=n.useState(!1),[k,m]=n.useState(""),[B,f]=n.useState(!1),[b,M]=n.useState(""),[T,F]=n.useState(""),[A,E]=n.useState(""),[g,G]=n.useState(""),N=t=>t.replace(/\D/g,"").slice(0,12).replace(/(\d{4})(?=\d)/g,"$1 "),R=t=>{M(N(t.target.value))},v=async()=>{c(!0),m(""),await new Promise(t=>setTimeout(t,1500)),c(!1),f(!0),r(I({message:s("auth.otpSent"),severity:"success"}))},w=async()=>{if(g.length!==6){m("Please enter a valid 6-digit OTP");return}c(!0),r(P());try{const t=b.replace(/\s/g,""),x=await fetch("http://localhost:4000/api/auth/aadhaar/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({aadhaar:t,otp:g})}),a=await x.json();if(!x.ok||!a.success)throw new Error(a.error||"Login failed");r(W({user:{id:a.user.id,name:a.user.name,mobile:a.user.mobile||"",email:a.user.email||"",aadhaarMasked:a.user.aadhaarMasked||`XXXX-XXXX-${t.slice(-4)}`,address:a.user.address||"",connections:a.user.connections||{}},token:a.token,refreshToken:a.refreshToken,expiresIn:a.expiresIn||900})),c(!1),r(I({message:`Welcome, ${a.user.name}!`,severity:"success"})),h("/dashboard")}catch(t){c(!1),m(t.message||"Login failed. Please try again."),r(Q(t.message||"Login failed"))}},U=async()=>{c(!0),r(P()),await new Promise(t=>setTimeout(t,1e3)),r(W({user:{id:"GUEST",name:"Guest User",mobile:"",connections:{}},token:"guest-token",refreshToken:"guest-refresh",expiresIn:300,isGuest:!0})),c(!1),h("/dashboard")};return e.jsx(d,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",py:4},children:e.jsxs(Y,{maxWidth:"sm",children:[e.jsx(q,{onClick:()=>h("/"),sx:{mb:2,backgroundColor:"white",boxShadow:1},children:e.jsx(Z,{})}),e.jsx(H.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs(d,{sx:{textAlign:"center",mb:4},children:[e.jsx(d,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:80,height:80,borderRadius:"50%",background:"linear-gradient(135deg, #1a73e8 0%, #34a853 100%)",boxShadow:"0 8px 32px rgba(26, 115, 232, 0.3)",mb:2},children:e.jsx(i,{variant:"h3",sx:{color:"white",fontWeight:700},children:"S"})}),e.jsx(i,{variant:"h4",sx:{fontWeight:700,color:"primary.main"},children:"SUVIDHA"})]})}),e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsx(ee,{elevation:4,sx:{borderRadius:4},children:e.jsxs(te,{sx:{p:4},children:[e.jsx(i,{variant:"h5",align:"center",sx:{mb:1,fontWeight:600},children:s("auth.loginTitle")}),e.jsx(i,{variant:"body2",align:"center",color:"text.secondary",sx:{mb:3},children:s("auth.loginSubtitle")}),k&&e.jsx(X,{severity:"error",sx:{mb:2},children:k}),e.jsxs(se,{value:u,onChange:(t,x)=>{V(x),f(!1),m("")},variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(C,{icon:e.jsx(z,{}),label:"Aadhaar",sx:{minHeight:72}}),e.jsx(C,{icon:e.jsx(L,{}),label:"Consumer ID",sx:{minHeight:72}}),e.jsx(C,{icon:e.jsx(O,{}),label:"DigiLocker",sx:{minHeight:72}})]}),e.jsx(S,{value:u,index:0,children:B?e.jsxs(e.Fragment,{children:[e.jsx(X,{severity:"info",sx:{mb:3},children:s("auth.otpSent")}),e.jsx(p,{fullWidth:!0,label:s("auth.enterOtp"),value:g,onChange:t=>G(t.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"------",InputProps:{startAdornment:e.jsx(j,{position:"start",children:e.jsx(ae,{color:"primary"})})},sx:{mb:2}}),e.jsxs(d,{sx:{display:"flex",gap:2},children:[e.jsx(o,{variant:"outlined",onClick:()=>f(!1),sx:{flex:1,minHeight:48},children:s("common.back")}),e.jsx(o,{variant:"contained",onClick:w,disabled:g.length!==6||l,sx:{flex:2,minHeight:48},children:l?e.jsx(y,{size:24}):s("auth.verifyOtp")})]}),e.jsx(o,{fullWidth:!0,variant:"text",sx:{mt:2},onClick:v,children:s("auth.resendOtp")})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{fullWidth:!0,label:s("auth.enterAadhaar"),value:b,onChange:R,placeholder:"XXXX XXXX XXXX",InputProps:{startAdornment:e.jsx(j,{position:"start",children:e.jsx(z,{color:"primary"})})},sx:{mb:3}}),e.jsx(o,{fullWidth:!0,variant:"contained",size:"large",onClick:v,disabled:b.replace(/\s/g,"").length!==12||l,sx:{minHeight:56},children:l?e.jsx(y,{size:24}):"Send OTP"})]})}),e.jsxs(S,{value:u,index:1,children:[e.jsx(p,{fullWidth:!0,label:s("auth.enterConsumerId"),value:T,onChange:t=>F(t.target.value),InputProps:{startAdornment:e.jsx(j,{position:"start",children:e.jsx(L,{color:"primary"})})},sx:{mb:2}}),e.jsx(p,{fullWidth:!0,label:s("auth.enterMobile"),value:A,onChange:t=>E(t.target.value.replace(/\D/g,"").slice(0,10)),InputProps:{startAdornment:e.jsx(j,{position:"start",children:e.jsx(re,{color:"primary"})})},sx:{mb:3}}),e.jsx(o,{fullWidth:!0,variant:"contained",size:"large",onClick:v,disabled:!T||A.length!==10||l,sx:{minHeight:56},children:l?e.jsx(y,{size:24}):"Send OTP"})]}),e.jsx(S,{value:u,index:2,children:e.jsxs(d,{sx:{textAlign:"center",py:3},children:[e.jsx(O,{sx:{fontSize:64,color:"primary.main",mb:2}}),e.jsx(i,{variant:"body1",sx:{mb:3},children:"Login securely using your DigiLocker account"}),e.jsx(o,{fullWidth:!0,variant:"contained",size:"large",sx:{minHeight:56},onClick:()=>{w()},children:"Continue with DigiLocker"})]})}),e.jsx(K,{sx:{my:3},children:e.jsx(i,{variant:"body2",color:"text.secondary",children:"OR"})}),e.jsx(o,{fullWidth:!0,variant:"outlined",size:"large",startIcon:e.jsx(ne,{}),onClick:U,disabled:l,sx:{minHeight:56},children:s("auth.guestMode")}),e.jsx(i,{variant:"caption",display:"block",textAlign:"center",color:"text.secondary",sx:{mt:2},children:"Guest mode has limited access. Session expires in 5 minutes."})]})})}),e.jsx(d,{sx:{textAlign:"center",mt:3},children:e.jsxs(i,{variant:"body2",color:"text.secondary",children:[s("auth.newUser")," ",e.jsx(o,{variant:"text",sx:{textTransform:"none"},children:s("auth.registerNow")})]})})]})})};export{be as default};
//# sourceMappingURL=LoginPage-BVf76F6V.js.map
